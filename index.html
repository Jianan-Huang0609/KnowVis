<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>读书笔记 · 指令生成器</title>
  <!-- TailwindCSS CDN -->
  <script src="https://cdn.tailwindcss.com">
  function resetForm(){
    try{
      // Text inputs
      const ids = ['title','outname','langmix','chartlib','links','rawtext'];
      ids.forEach(id => { const el = document.getElementById(id); if(el){ el.value = ''; }});

      // File input
      const filesEl = document.getElementById('files'); if(filesEl){ filesEl.value=''; }

      // Color reset
      if(document.getElementById('colorHex')){ document.getElementById('colorHex').value = '#F05E1C'; }
      if(document.getElementById('color')){ document.getElementById('color').value = '#F05E1C'; }
      document.documentElement.style.setProperty('--primary', '#F05E1C');

      // Outline controls
      const density = document.getElementById('outlineDensity'); if(density){ density.value = 'standard'; }
      const tables = document.getElementById('tables'); if(tables){ tables.value = 'auto'; }
      const charts = document.getElementById('chartsHint'); if(charts){ charts.checked = true; }
      const bullets = document.getElementById('bulletsMax'); if(bullets){ bullets.value = 6; }
      const moduleSplit = document.getElementById('moduleSplit'); if(moduleSplit){ moduleSplit.checked = true; }

      // Output & status
      const out = document.getElementById('output'); if(out){ out.value=''; }
      const status = document.getElementById('status'); if(status){ status.textContent = '🧹 已重置'; }
    }catch(e){
      const out = document.getElementById('output'); if(out){ out.value = '❌ 重置失败：' + e.message; }
      const status = document.getElementById('status'); if(status){ status.textContent = '❌ 重置失败'; }
      console.error(e);
    }
  }

</script>
  <style>
    :root{ --primary:#F05E1C; }
    .bento{ display:grid; grid-template-columns:repeat(12,1fr); gap:12px; }
    .card{ background:#fff; border:1px solid #eee; border-radius:18px; padding:16px; box-shadow:0 10px 30px rgba(0,0,0,.04); }
    .accent{ background: linear-gradient(135deg, rgba(240,94,28,0.14), rgba(240,94,28,0.03)); }
    .bignum{ font-size:56px; font-weight:800; letter-spacing:-1px; line-height:1; color:var(--primary); }
    .ghost{ color:#9ca3af }
    .chip{ border:1px dashed rgba(240,94,28,.35); color:#ef6a2f; padding:2px 8px; border-radius:999px; font-size:12px; }
    .btn{ background:var(--primary); color:#fff; border-radius:12px; padding:10px 16px; font-weight:600; }
    .btn-outline{ border:1px solid var(--primary); color:var(--primary); background:#fff; border-radius:12px; padding:10px 16px; font-weight:600; }
    textarea{ white-space:pre; }
    .switch { position: relative; display: inline-block; width: 42px; height: 24px; }
    .switch input { display:none; }
    .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #e5e7eb; transition: .2s; border-radius:999px; }
    .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .2s; border-radius: 50%; box-shadow: 0 1px 3px rgba(0,0,0,.2); }
    input:checked + .slider { background-color: var(--primary); }
    input:checked + .slider:before { transform: translateX(18px); }
  </style>
</head>
<body class="bg-white text-gray-900">
  <div class="max-w-6xl mx-auto px-4 py-8">
    <!-- HERO -->
    <header class="mb-8 bento">
      <div class="card accent col-span-12 md:col-span-8 flex items-center justify-between">
        <div>
          <div class="bignum">读书笔记 · 指令生成器</div>
          <p class="mt-2 text-sm text-gray-600">
            CN 主信息 / <span class="ghost">EN for tiny hints.</span>
            上传文件或粘贴文字 → 一键生成网页设计 Prompt（含单文件 HTML 站点要求 + 大纲生成方向）。
          </p>
        </div>
        <div class="hidden md:block text-right">
          <div class="chip">Bento Grid</div>
          <div class="mt-2 chip">#F05E1C Highlight</div>
        </div>
      </div>
      <div class="card col-span-12 md:col-span-4">
        <label class="text-sm text-gray-500">主题高亮色</label>
        <div class="mt-2 flex items-center gap-3">
          <input id="color" type="color" value="#F05E1C" class="w-12 h-10 rounded" />
          <input id="colorHex" type="text" value="#F05E1C" class="border rounded px-3 py-2 w-40" />
        </div>
        <p class="mt-2 text-xs text-gray-500">支持 #F05E1C 这样的十六进制。非法值会自动回退到 #F05E1C。</p>
      </div>
    </header>

    <!-- FORM -->
    <section class="bento">
      <div class="card col-span-12 md:col-span-12">
        <div class="flex items-center justify-between">
          <h2 class="font-bold text-xl">1 · 输入材料 / Inputs</h2>
          <span class="chip">Attachments / Text / Links</span>
        </div>
        <div class="mt-4 grid md:grid-cols-2 gap-4">
          <div>
            <label class="text-sm text-gray-500">项目标题（中文大字）</label>
            <input id="title" class="mt-1 border rounded px-3 py-2 w-full" placeholder="软件注册指导原则要点" />
          </div>
          <div>
            <label class="text-sm text-gray-500">输出 HTML 文件名</label>
            <input id="outname" class="mt-1 border rounded px-3 py-2 w-full" placeholder="medsw_guidance_notes" />
          </div>
          <div>
            <label class="text-sm text-gray-500">语言配比（CN:EN）</label>
            <input id="langmix" class="mt-1 border rounded px-3 py-2 w-full" placeholder="CN:EN = 80:20" />
          </div>
          <div>
            <label class="text-sm text-gray-500">在线图表（可选，占位库名）</label>
            <input id="chartlib" class="mt-1 border rounded px-3 py-2 w-full" placeholder="ECharts / Chart.js / Observable Plot" />
          </div>
        </div>
        <div class="mt-4">
          <label class="text-sm text-gray-500">添加链接（每行一个）</label>
          <textarea id="links" rows="4" class="mt-1 border rounded px-3 py-2 w-full" placeholder="https://..."></textarea>
        </div>
        <div class="mt-4">
          <label class="text-sm text-gray-500">粘贴文本（可多段）</label>
          <textarea id="rawtext" rows="6" class="mt-1 border rounded px-3 py-2 w-full" placeholder="可粘贴学习摘录、要点、目录…"></textarea>
        </div>
        <div class="mt-4">
          <label class="text-sm text-gray-500">上传文件（仅记录文件名）</label>
          <input id="files" type="file" multiple class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-semibold file:bg-orange-50 file:text-orange-600 hover:file:bg-orange-100" />
          <p class="mt-1 text-xs text-gray-500">本页面不读取文件内容，仅把文件名加入指令清单；解析在 AI 端执行。</p>
        </div>
      </div>

      <div class="card col-span-12 md:col-span-6">
          <h2 class="font-bold text-xl">2 · 大纲生成选项 / Outline Controls</h2>
        <div class="mt-3 grid grid-cols-1 gap-3">
          <div class="flex items-center justify-between">
            <label class="text-sm text-gray-600">大纲密度</label>
            <select id="outlineDensity" class="border rounded px-3 py-2">
              <option value="compact">精简（总字数 &lt; 800）</option>
              <option value="standard" selected>标准（800–1200）</option>
              <option value="detailed">详细（1500+）</option>
            </select>
          </div>
          <div class="flex items-center justify-between">
            <label class="text-sm text-gray-600">是否包含数据表</label>
            <select id="tables" class="border rounded px-3 py-2">
              <option value="auto" selected>自动判断</option>
              <option value="force">强制包含</option>
              <option value="none">不包含</option>
            </select>
          </div>
          <div class="flex items-center justify-between">
            <label class="text-sm text-gray-600">是否提供图表建议</label>
            <label class="switch">
              <input id="chartsHint" type="checkbox" checked />
              <span class="slider"></span>
            </label>
          </div>
          <div class="flex items-center justify-between">
            <label class="text-sm text-gray-600">每模块要点上限（3–8）</label>
            <input id="bulletsMax" type="number" min="3" max="8" step="1" value="6" class="border rounded px-3 py-2 w-24" />
          </div>
          <div class="flex items-center justify-between">
            <label class="text-sm text-gray-600">是否按法规/章节分模块</label>
            <label class="switch">
              <input id="moduleSplit" type="checkbox" checked />
              <span class="slider"></span>
            </label>
          </div>
        </div>
      </div>

      <div class="card col-span-12 md:col-span-6">
        <h2 class="font-bold text-xl">3 · 生成 / Generate</h2>
        <p class="mt-2 text-sm text-gray-600">点击按钮，组合完整 Prompt。无需每项都填，留空会自动使用合理默认值。</p>
        <div class="mt-4 flex flex-col gap-3">
          <button class="btn" onclick="safeGenerate()">生成指令</button>
          <button class="btn-outline" onclick="copyPrompt()">复制到剪贴板</button>
          <button class="btn-outline" onclick="downloadPrompt()">下载为 .txt</button>
        </div>
        <div class="mt-2">
          <button class="btn-outline" onclick="resetForm()">重置（清空所有输入）</button>
        </div>
        <div class="mt-6">
          <label class="text-sm text-gray-500">快速预设</label>
          <div class="mt-2 flex gap-2 flex-wrap">
            <button class="chip" onclick="preset('software')">软件注册指导原则</button>
            <button class="chip" onclick="preset('generic')">通用读书笔记</button>
          </div>
        </div>
      </div>

      <div class="card col-span-12">
        <div class="flex items-center justify-between">
          <h2 class="font-bold text-xl">4 · 生成结果 / Prompt Output</h2>
          <span id="status" class="text-xs text-gray-500"></span>
        </div>
        <textarea id="output" rows="20" class="mt-3 w-full border rounded px-3 py-2 text-sm" placeholder="点击『生成指令』后会在此出现完整 Prompt"></textarea>
      </div>
    </section>

    <!-- FOOT -->
    <footer class="mt-8 text-center text-xs text-gray-500">
      Made for quick workflow · Bento UI · Single-file HTML。
    </footer>
  </div>

<script>
  // Helpers
  const $ = (id) => document.getElementById(id);
  const HEX_OK = /^#([0-9a-fA-F]{6}|[0-9a-fA-F]{3})$/;

  // Keep color hex synced + tolerate invalid values
  const color = $('color');
  const colorHex = $('colorHex');
  function applyColor(hex){
    const ok = HEX_OK.test(hex);
    const val = ok ? hex : '#F05E1C';
    document.documentElement.style.setProperty('--primary', val);
    color.value = val;
    colorHex.value = val;
  }
  color.addEventListener('input', e => applyColor(e.target.value));
  colorHex.addEventListener('input', e => applyColor(e.target.value));

  function preset(type){
    if(type === 'software'){
      $('title').value = '软件注册指导原则要点';
      $('outname').value = 'medsw_guidance_notes';
      $('langmix').value = 'CN:EN = 80:20';
      $('chartlib').value = 'ECharts';
      applyColor('#F05E1C');
    } else {
      $('title').value = '读书笔记要点';
      $('outname').value = 'reading_notes_site';
      $('langmix').value = 'CN:EN = 70:30';
      $('chartlib').value = 'Chart.js';
      applyColor('#2F80ED');
    }
    $('status').textContent = '已加载预设';
  }

  function generateDocList(){
    const files = Array.from(($('files') && $('files').files) || []);
    const links = (($('links') && $('links').value) || '').split('\\n').map(s=>s.trim()).filter(Boolean);
    const textLen = (($('rawtext') && $('rawtext').value) || '').trim().length;
    const parts = [];
    files.forEach((f,i)=> parts.push(`- 附件${i+1}：${f.name}`));
    links.forEach((l,i)=> parts.push(`- 链接${i+1}：${l}`));
    if(textLen>0){ parts.push(`- 文本：已粘贴（约 ${textLen} 字）`); }
    return parts.join('\\n') || '- （稍后补充附件/链接/文本）';
  }

  function buildTaskAplus(){
    const density = ($('outlineDensity') && $('outlineDensity').value) || 'standard';
    const tables = ($('tables') && $('tables').value) || 'auto';
    const chartsHint = !!($('chartsHint') && $('chartsHint').checked);
    const bulletsMax = parseInt((($('bulletsMax') && $('bulletsMax').value) || '6'), 10);
    const moduleSplit = !!($('moduleSplit') && $('moduleSplit').checked);

    const densityText = {
      compact: '精简版（总字数 < 800）',
      standard: '标准版（800–1200）',
      detailed: '详细版（1500+）'
    }[density] || '标准版（800–1200）';

    const tablesText = {
      auto: '自动判断是否需要表格；如发现结构化数据则采用 Markdown 表格呈现。',
      force: '强制包含 1–3 张数据表（如无结构化数据则基于要点构造最小表）。',
      none: '不使用表格呈现，仅以要点列表表达。'
    }[tables] || '自动判断是否需要表格；如发现结构化数据则采用 Markdown 表格呈现。';

    const chartLine = chartsHint
      ? '6. **数据可视化提示**：标记适合转化为图表的内容，并注明推荐图表类型（柱状/折线/饼图/关系图等）。'
      : '6. **数据可视化提示**：如内容不适合可省略。';

    const moduleSplitLine = moduleSplit
      ? '4. **模块划分**：按法规或主题章节拆分，确保每个模块独立成段。'
      : '4. **模块划分**：不强制按章节拆分，以叙述逻辑分段。';

    return `### 任务 A+｜大纲生成方向与内容密度控制
- **大纲篇幅**：${densityText}
- **每模块要点上限**：${bulletsMax} 条
- **是否包含数据表**：${tablesText}
${moduleSplitLine}
5. **网页映射**：标明大纲中每个模块在网页中的布局位置（Header/Main Body/Mid-Breaker/Footer）。
${chartLine}`;
  }

  function generatePrompt(){
    const title = (($('title') && $('title').value) || '软件注册指导原则要点').trim();
    const primary = (($('colorHex') && $('colorHex').value) || '#F05E1C').trim();
    const outname = (($('outname') && $('outname').value) || 'medsw_guidance_notes').trim();
    const langmix = (($('langmix') && $('langmix').value) || 'CN:EN = 80:20').trim();
    const chartlib = (($('chartlib') && $('chartlib').value) || '').trim();
    const doclist = generateDocList();

    const intro = `你是“读书笔记网站生成器”。我会给你若干 **附件/文本/链接**，请完成两件事：`;

    const taskA = `### 任务 A｜生成系统化读书笔记（Markdown）
1. **总纲**：用 5–9 条“超大要点”概括核心思想，每条 ≤ 18 字；并给 1 句英文小字点缀。
2. **章节框架**：按原文**目录顺序**输出两层结构（章节标题+3–6 条要点，动宾结构）。
3. **术语卡**：列 8–15 个关键术语：中文（加粗）/ English（小字）/ 一句话定义。
4. **图示草稿**：给出 2–3 个“勾线图”文字草稿（说明节点与连线）。
5. **引用溯源**：每个要点标注【Ref】如 [来源名/章节/页码或段落]。`;

    const taskAplus = buildTaskAplus();

    const taskB = `### 任务 B｜生成“单文件前端网页”的源码（可直接拷贝为 .html）
**页面标题**：${title}

**核心设计哲学**
- 数字时代的印刷品：信息饱和、布局紧凑、字体突出，以视觉冲击替代留白。
- 四段结构（必须逐字遵守）：Header（刊头） / Main Body（4+8 非对称 Bento Grid） / Mid-Breaker（中段分隔区） / Dark Footer（深色页脚）。

**页面蓝图（硬性）**
1) Header：主标题/副标题/发布日期/作者，中文大号粗体；英文为小字点缀；可用细分隔线/纹理。
2) Main Body（12 栅格 → 4+8）：
   - 视觉锚点区（4列）：放置**巨大、描边、空心**的字母/数字/图标，形成压倒性视觉冲击；描边颜色采用主题色。
   - 核心信息区（8列）：紧凑卡片/列表，高密度排布；**严格按输入文本顺序**展示，不得省略任何要点。
3) Mid‑Breaker：页面中下部全宽，背景/布局与主区明显不同，用于次要信息、数据或引用，承担节奏切分。
4) Dark Footer：深色背景 #1f2937（或更深），对比度 ≥ 7:1，放置总结性观点或 CTA（行动号召），附版权/联系。

**设计基因（必须严格执行）**
- 字体：中文使用 Noto Serif SC（或等价回退），标题/正文字号比常规网页大 1–2 级；中文加粗，英文小字点缀。
- 用色：纯白底 + 主题高亮色 ${primary}；可用**同一高亮色的透明度渐变**营造科技感，**不同高亮色之间禁止互相渐变**。
- 图形化：使用**勾线风格（SVG）**制作 2–3 个关系图/流程图，线条简洁，呼应主题色。
- 对比：用**超大数字/短词**作为章节锚点（01/02/03…），和小元素形成强烈比例反差。
- 排版密度：卡片外间距 ≤16px，内间距 ≤16px；列表行距 1.2–1.35；强调信息饱和与分组清晰。

**动效与交互**
- 模仿 Apple 官网滚动节奏：向下滚动时元素位移/透明度/缩放轻微变化，平滑不炫技。
- 使用 **Framer Motion（通过 CDN 引入）**；需提供 \`prefers-reduced-motion\` 友好降级（或 IntersectionObserver+CSS）。
- 视觉锚点允许轻微视差（3–6%）与描边强调；卡片 hover 微缩放 ≤1.02。

**数据可视化**
- 可引用在线图表组件（${chartlib || 'Chart.js 或 ECharts'}），配色与字体需与主题一致；图例/坐标轴最简，强调关键数值。

**图标与禁止项**
- 图标库：Font Awesome 或 Material Icons（CDN 引入）。
- **禁止**以 emoji 作为主要图标。

**技术与交付（硬性）**
- 技术栈：HTML5、TailwindCSS 3+、Framer Motion（CDN）、所选图表库（CDN）。
- 输出：**单一 HTML 文件**（仅一份），CSS 允许用 CDN；JS 使用内联 <script>；包含 \`exportHTML()\`，下载文件名为 \`${outname}.html\`。
- 配置：暴露 \`CONFIG = { primaryColor: '${primary}', langMix: '${langmix}', density: 'cozy' }\`。
- 无障碍：语义标签完整（header/main/section/aside/footer），Tab 可聚焦，链接 hover 有下划线（非仅靠颜色区分），打印样式友好。

**必须包含的内容**
- 任务 A 的总纲/章节框架/术语卡/勾线图草稿/引用溯源，**全部**纳入网页并与 Bento 结构对齐。
- **严格按照输入文本内容的顺序排布**，分布整齐，不要出现大段空白。
- **不得省略**任意内容要点。`;

    const materials = `**输入材料**
${doclist}`;

    const finalOut = `**最终输出**
- 先给出 A（Markdown 笔记），再给出 A+（大纲方向参数回显），最后给出 B（完整 HTML 源码，单文件，可直接运行）。`;

    const payload = `**PROMPT — BEGIN**

${intro}

${taskA}

${taskAplus}

${taskB}

${materials}

${finalOut}

**PROMPT — END**`;

    return payload;
  }

  function safeGenerate(){
    const status = $('status');
    try{
      const prompt = generatePrompt();
      $('output').value = prompt;
      status.textContent = '✅ 已生成';
    }catch(err){
      $('output').value = '❌ PROMPT 生成失败：' + (err && err.message ? err.message : String(err));
      status.textContent = '❌ 出错';
      console.error(err);
    }
  }

  function copyPrompt(){
    try{
      const el = $('output');
      el.select();
      document.execCommand('copy');
      $('status').textContent = '📋 已复制到剪贴板';
    }catch(err){
      $('status').textContent = '⚠️ 复制失败，可手动选中复制或用下方“下载为 .txt”。';
    }
  }

  function downloadPrompt(){
    const text = ($('output') && $('output').value) || '';
    const blob = new Blob(['\ufeff'+text], {type:'text/plain;charset=utf-8'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'prompt.txt'; a.click();
    setTimeout(()=> URL.revokeObjectURL(url), 500);
    $('status').textContent = '⬇️ 已下载 prompt.txt';
  }

  function resetForm(){
    try{
      // Text inputs
      const ids = ['title','outname','langmix','chartlib','links','rawtext'];
      ids.forEach(id => { const el = document.getElementById(id); if(el){ el.value = ''; }});

      // File input
      const filesEl = document.getElementById('files'); if(filesEl){ filesEl.value=''; }

      // Color reset
      if(document.getElementById('colorHex')){ document.getElementById('colorHex').value = '#F05E1C'; }
      if(document.getElementById('color')){ document.getElementById('color').value = '#F05E1C'; }
      document.documentElement.style.setProperty('--primary', '#F05E1C');

      // Outline controls
      const density = document.getElementById('outlineDensity'); if(density){ density.value = 'standard'; }
      const tables = document.getElementById('tables'); if(tables){ tables.value = 'auto'; }
      const charts = document.getElementById('chartsHint'); if(charts){ charts.checked = true; }
      const bullets = document.getElementById('bulletsMax'); if(bullets){ bullets.value = 6; }
      const moduleSplit = document.getElementById('moduleSplit'); if(moduleSplit){ moduleSplit.checked = true; }

      // Output & status
      const out = document.getElementById('output'); if(out){ out.value=''; }
      const status = document.getElementById('status'); if(status){ status.textContent = '🧹 已重置'; }
    }catch(e){
      const out = document.getElementById('output'); if(out){ out.value = '❌ 重置失败：' + e.message; }
      const status = document.getElementById('status'); if(status){ status.textContent = '❌ 重置失败'; }
      console.error(e);
    }
  }

</script>

  <!-- Bottom signature bar -->
  <div class="w-full mt-6 py-5 text-center text-sm bg-gray-100 border-t">🌊 <span class="font-semibold" style="color: var(--primary)">@Jianan</span> · 做医械RA圈 🩺 · 最懂AI 🤖 · 爱游泳 🏊 · 辩论选手 🎤</div>

</body>
</html>
